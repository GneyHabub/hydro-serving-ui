<div class="visualization">
  <div class="visualization__loader" *ngIf="(status$ | async) === 'PENDING'">
    <hydro-icon type="scatter" class="visualization__loader-icon"></hydro-icon>
    <span class="visualization__loader-status"
      >Task id: {{ taskId$ | async }}</span
    >
  </div>
  <div class="visualization__error" *ngIf="(status$ | async) === 'FAILED'">
    <hydro-icon type="circle-x" class="visualization__error-icon"></hydro-icon>
    <div class="visualization__error-message">
      <hs-error-message>
        {{ error$ | async | json }}
      </hs-error-message>
    </div>
    <button kind="flat" color="cyan" (click)="retryRequest()" hs-button>
      Create new task
    </button>
  </div>
  <div class="visualization__body" *ngIf="(status$ | async) === 'SUCCESS'">
    <div class="visualization__chart">
      <div class="visualization__settings">
        <hs-color-by-selector
          class="visualization__settings-item"
          [colorBy]="colorBy$ | async"
          (colorByChanged)="onColorByChange($event)"
        ></hs-color-by-selector>
        <hs-color-by-class-label-options
          class="visualization__settings-item"
          [labelName]="selectedLabel"
          [labelNames]="labelsNames$ | async"
          (labelNameChanged)="handleSelectLabel($event)"
        ></hs-color-by-class-label-options>
        <!-- <hs-color-by-metric-options
        class="visualization__settings-item"
        *ngIf="(colorBy$ | async) === 'metric'"
        [metric]="selectedMetric$ | async"
        [metricName]="selectedMetricName$ | async"
        [metricsNames]="metrics$ | async"
        (metricNameChanged)="handleSelectMetric($event)"
      ></hs-color-by-metric-options> -->
        <mdl-checkbox
          [(ngModel)]="showTop100"
          class="visualization__setting-item"
        >
          Show nearest points
        </mdl-checkbox>
      </div>
      <div class="visualization__scatterplot">
        <hs-scatter-plot
          [data]="scatterPlotData$ | async"
          [colors]="colors$ | async"
          [top100]="top100$ | async"
          [showTop100]="false"
          (selectPoint)="handleSelectPoint($event)"
        ></hs-scatter-plot>
      </div>
    </div>

    <div class="visualization__detail">
      <hs-log-detail
        *ngIf="modelVersion$ | async"
        [check]="selectedCheck$ | async"
        [modelVersion]="modelVersion$ | async"
      ></hs-log-detail>
    </div>
  </div>
</div>
