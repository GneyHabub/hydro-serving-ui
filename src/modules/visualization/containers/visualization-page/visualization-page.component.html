<div class="visualization">
  <div *ngIf="loading$ | async" class="visualization__loader">
    loading
  </div>
  <div class="visualization__body">
    <div class="visualization__settings">
      <hs-color-by-selector
        class="visualization__settings-item"
        [colorBy]="colorBy$ | async"
        (colorByChanged)="onColorByChange($event)"
      ></hs-color-by-selector>
      <hs-color-by-class-label-options
        class="visualization__settings-item"
        *ngIf="(colorBy$ | async) === 'class'"
        [labelName]="selectedLabel"
        [labelNames]="labels$ | async"
        (labelNameChanged)="handleSelectLabel($event)"
      ></hs-color-by-class-label-options>
      <hs-color-by-metric-options
        class="visualization__settings-item"
        *ngIf="(colorBy$ | async) === 'metric'"
        [metric]="selectedMetric$ | async"
        [metricName]="selectedMetricName$ | async"
        [metricsNames]="metrics$ | async"
        (metricNameChanged)="handleSelectMetric($event)"
      ></hs-color-by-metric-options>
      <mdl-checkbox
        [(ngModel)]="showTop100"
        class="visualization__setting-item"
      >
        Show nearest points
      </mdl-checkbox>
    </div>
    <hs-scatter-plot
      class="visualization__chart"
      [data]="scatterPlotData$ | async"
      [colors]="colors$ | async"
      [top100]="top100$ | async"
      [showTop100]="showTop100"
      (selectPoint)="handleSelectPoint($event)"
    ></hs-scatter-plot>
    <div class="visualization__detail">
      <ng-template
        [ngTemplateOutlet]="point"
        [ngTemplateOutletContext]="selectedPoint$ | async"
      ></ng-template>
    </div>
  </div>
</div>

<ng-template let-x="x" let-y="y" #point>
  <div class="visualization__detail-point">
    <div>
      <span>x: {{ x }}</span>
    </div>
    <div>
      <span>y: {{ y }}</span>
    </div>
  </div>
</ng-template>
